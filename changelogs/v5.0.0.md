# ClawPanel v5.0.0 — 全栈重写 · Go + React 单二进制部署

**发布日期**: 2026-02-22

## 🔥 重大变更

### 全栈架构重写
- **后端**：从 Node.js/Express 完全迁移至 **Go (Gin)**，单二进制静态编译
- **前端**：React 18 + TypeScript + TailwindCSS + Lucide Icons，通过 `go:embed` 内嵌
- **数据库**：SQLite (modernc.org/sqlite 纯 Go 驱动)，无需 CGO
- **部署**：单个二进制文件即可运行，无需 Node.js/Docker/数据库等外部依赖

### 旧版本完全移除
- 移除 Node.js 后端 (`server/` 目录)
- 移除 Docker Compose 部署方式 (`Dockerfile`, `docker-compose.yml`)
- 移除旧版安装脚本 (`install.sh`, `install.ps1`, `install-mac.sh`)
- 移除旧版 QQ 插件 (`docker/qq-plugin/`)
- 移除旧版配置脚本 (`setup-openclaw.sh`, `setup-openclaw.ps1`)
- 移除 demo 构建产物 (`web/dist-demo/`)

## ✨ 新功能

### 核心功能
- **进程管理器**：内置 OpenClaw 进程管理（启动/停止/重启/监控）
- **WebSocket 实时日志**：进程日志和事件通过 WebSocket 实时推送到前端
- **JWT 认证**：7 天有效期，支持密码修改
- **配置备份与恢复**：一键备份/恢复 OpenClaw 配置，恢复前自动备份

### AI 智能助手
- 内置 AI 对话助手浮窗
- 支持多提供商/多模型切换（OpenAI / Anthropic / Google GenAI / DeepSeek 等）
- 自动使用 OpenClaw 已配置的 API

### 通道管理增强
- 20+ 通道统一配置和一键启用/禁用
- QQ (NapCat) 扫码/快速/密码三种登录方式
- **NapCat 容器管理**：退出登录、重启 NapCat 容器
- **QR 码刷新修复**：智能重试机制，确保刷新后获取全新二维码
- NapCat `reportSelfMessage` 自动启用，活动日志显示 Bot 回复消息

### 事件日志系统
- SQLite 持久化存储，重启不丢失
- 按来源/类型筛选、关键词搜索
- OneBot11 WebSocket 事件监听器自动采集 QQ 消息
- 外部服务日志接入（POST /api/events）

### 系统管理
- **快捷重启按钮**：一键重启 OpenClaw / 网关 / ClawPanel / NapCat
- **软件安装中心**：一键安装 Docker、NapCat、微信机器人等容器
- **消息中心**：安装任务进度实时追踪
- 系统环境检测（OS / CPU / Go / OpenClaw 版本）
- 版本更新检查

### 安装部署
- **Linux/macOS 一键安装脚本**：自动注册 systemd/launchd 服务、开机自启动
- **Windows PowerShell 安装脚本**：自动注册 Windows 服务
- **Windows exe 安装包**：基于 Go 的原生安装程序
- 跨平台交叉编译：Linux / macOS / Windows × x86_64 / ARM64

### UI/UX
- 响应式设计：PC 侧边栏 + 移动端底部导航
- 深色/浅色主题切换
- 中英文双语 (i18n)
- 紫罗兰品牌主题

## 🐛 Bug 修复
- 修复 QR 码刷新返回过期二维码的问题（增加新旧 URL 对比 + 重试机制）
- 修复退出 QQ 登录后容器未真正重启的问题（NapcatLogout 现在执行 docker restart）
- 修复活动日志不显示的问题（前端 API 响应字段名不匹配）
- 修复活动日志不显示 OpenClaw 回复消息的问题（启用 reportSelfMessage）
- 自动为非 OpenAI 提供商注入 `compat.supportsDeveloperRole=false` 兼容性修复

## 🏗️ 技术栈

| 层级 | 技术 |
|:---|:---|
| 后端 | Go 1.22+ · Gin · SQLite (modernc.org/sqlite) · gorilla/websocket · golang-jwt |
| 前端 | React 18 · TypeScript · TailwindCSS · Lucide Icons · Vite |
| 部署 | 单二进制 · `go:embed` 内嵌前端 · 跨平台静态编译 (CGO_ENABLED=0) |
| AI 引擎 | [OpenClaw](https://openclaw.ai) |

## 📦 升级指南

v5.0.0 是全栈重写版本，与 v4.x 不兼容。请按以下步骤升级：

1. 备份 OpenClaw 配置（`~/.openclaw/openclaw.json`）
2. 停止旧版 ClawPanel（`docker compose down` 或停止 Node.js 进程）
3. 使用一键安装脚本安装 v5.0.0：
   ```bash
   curl -sSO https://raw.githubusercontent.com/zhaoxinyi02/ClawPanel/main/scripts/install.sh && sudo bash install.sh
   ```
4. 访问 `http://localhost:19527`，默认密码 `clawpanel`
